<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>La Nuit du Pacte — Rituel</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel&family=Cormorant+Garamond&display=swap" rel="stylesheet">
<style>
  body{
    background: radial-gradient(#2b2118,#0f0b08);
    color:#e9d8c7;
    font-family: "Cormorant Garamond", "Cinzel", serif;
    padding:24px;
    display:flex;
    min-height:100vh;
    align-items:center;
    justify-content:center;
    transition: background 0.8s ease, color 0.8s ease;
  }
  .card{
    max-width:760px;
    background: linear-gradient(180deg, rgba(255,250,240,0.03), rgba(0,0,0,0.25));
    border:1px solid rgba(233,216,199,0.06);
    padding:28px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.6);
    border-radius:8px;
    transition: opacity 0.8s ease;
  }
  h1{ text-align:center; letter-spacing:2px; margin:0 0 8px; font-size:22px;}
  p.lead{ text-align:center; opacity:0.9; margin-top:4px; margin-bottom:18px;}
  .ritualText{
    background: rgba(0,0,0,0.45);
    border: 1px solid rgba(255,255,255,0.03);
    padding:18px;
    min-height:120px;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    font-size:18px;
    line-height:1.45;
    border-radius:6px;
    transition: opacity 0.5s ease, transform 0.2s ease;
    opacity: 1;
  }
  .controls{ display:flex; gap:10px; margin-top:14px; justify-content:center;}
  button{ background:#7a4b35; color:#fff; border:none; padding:10px 14px; border-radius:6px; cursor:pointer;}
  button:disabled { opacity: 0.5; cursor: not-allowed; }
  button.secondary{ background:transparent; border:1px solid rgba(255,255,255,0.06);}
  .hint{ text-align:center; margin-top:12px; color:#cfc1ad; font-size:13px;}
  #afterText{
    margin-top:18px;
    text-align:center;
    font-style:italic;
    opacity:0;
    transition: opacity 1.6s ease;
  }
</style>
</head>
<body>
  <div class="card">
    <h1>La Nuit du Pacte — Rituel</h1>
    <p class="lead">Approche-toi. Pose ta main sur le grimoire et clique pour connaître ta marque.  
    Tu devras jouer cet effet pendant 24 h.</p>

    <div id="ritualText" class="ritualText">Le grimoire attend ton souffle...</div>

    <div class="controls">
      <button id="drawBtn">Effectuer ton sacrifice</button>
      <button id="copyBtn" class="secondary" disabled>Copier ma malédiction</button>
    </div>

    <p id="afterText">Colle ta malédiction dans le chat et joue-la dès maintenant...<br>La suite arrivera une fois que tout le monde aura fait son sacrifice à la nuit.</p>

    <p class="hint">Chaque joueur ne doit tirer qu’une seule fois son sacrifice.</p>
  </div>

<script>
const entries = [
  "Quand la lune monte, ton ombre chuchote ton nom à l’envers.",
  "Les miroirs te renvoient un vide jusqu’à l’aube.",
  "Le parfum du sang te suit, même sous la pluie.",
  "Tes mains se couvrent de poussière chaque fois que tu mens.",
  "Tes cheveux s’enflammeront de rouge sous la lumière du jour.",
  "Les flammes vacillent à ton passage, même sans vent.",
  "Les animaux te fixent comme s’ils se souvenaient d’un serment ancien.",
  "Tu craches à chaque fois qu’un homme soutient ton regard.",
  "Tu ne pourras plus mentir sans que ton œil s’assombrisse comme une braise.",
  "Le goût du fer envahit ta bouche chaque fois qu’on prononce ton nom.",
  "Tes mots attirent les corbeaux ; ils te suivront désormais.",
  "T’es pas laisse de la cendre là où tu marches."
];

// =========================
// CONFIGURATION MODE
// =========================
const TEST_MODE = true; // true = tirage libre / répétable, false = tirage unique pour 12 joueurs
let shuffledEntries = [];
let currentIndex = 0;

if (!TEST_MODE) {
  shuffledEntries = shuffle([...entries]);
}

// Fonction pour mélanger un tableau (Fisher-Yates)
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// =========================
// Éléments DOM
// =========================
const drawBtn = document.getElementById('drawBtn');
const ritualText = document.getElementById('ritualText');
const copyBtn = document.getElementById('copyBtn');
const afterText = document.getElementById('afterText');
const body = document.body;
const card = document.querySelector('.card');

// =========================
// Événement clic
// =========================
drawBtn.addEventListener('click', () => {
  drawBtn.disabled = true; // bloque le bouton après un tirage

  // écran noir dramatique
  card.style.opacity = 0;
  body.style.background = "#000";
  body.style.color = "#000";

  setTimeout(() => {
    let text;
    if (TEST_MODE) {
      const idx = Math.floor(Math.random() * entries.length);
      text = entries[idx]; // tirage aléatoire libre
    } else {
      if (currentIndex >= shuffledEntries.length) return; // toutes tirées
      text = shuffledEntries[currentIndex];
      currentIndex++;
    }

    ritualText.textContent = text;

    // réaffichage de la carte et du texte
    card.style.opacity = 1;
    body.style.background = "radial-gradient(#2b2118,#0f0b08)";
    body.style.color = "#e9d8c7";

    copyBtn.disabled = false;
    afterText.style.opacity = 1;

    ritualText.style.transform = "scale(0.995)";
    setTimeout(() => ritualText.style.transform = "scale(1)", 180);

  }, 800); // durée écran noir
});

// =========================
// Bouton copier
// =========================
copyBtn.addEventListener('click', async () => {
  const text = ritualText.textContent;
  try {
    await navigator.clipboard.writeText(text);
    copyBtn.textContent = "Copié ✓";
    setTimeout(()=> copyBtn.textContent = "Copier ma malédiction", 2200);
  } catch(e) {
    alert("Impossible de copier automatiquement — sélectionne le texte et fais Copier manuellement.");
  }
});
</script>
</body>
</html>
